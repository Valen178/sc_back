=== DOCUMENTACIÃ“N DEL PROYECTO ===

ğŸ“ back/
â”œâ”€â”€ ğŸ“„ .env
â”‚   â””â”€â”€ Variables de entorno:
â”‚       - SUPABASE_URL
â”‚       - SUPABASE_ANON_KEY
â”‚       - PORT
â”‚       - JWT_SECRET
â”‚       - JWT_EXPIRES_IN
â”‚       - GOOGLE_CLIENT_ID
â”‚       - GOOGLE_CLIENT_SECRET
â”‚       - GOOGLE_CALLBACK_URL
â”‚
â”œâ”€â”€ ğŸ“„ .gitignore
â”‚   â””â”€â”€ Ignora:
â”‚       - node_modules
â”‚       - .env
â”‚
â”œâ”€â”€ ğŸ“„ package.json
â”‚   â””â”€â”€ Scripts:
â”‚       - "start": "node index.js"
â”‚       - "dev": "nodemon index.js"
â”‚
â”œâ”€â”€ ğŸ“„ index.js (Archivo principal)
â”‚   â””â”€â”€ ConfiguraciÃ³n:
â”‚       - Express
â”‚       - CORS
â”‚       - Middleware de seguridad
â”‚       - Rutas principales
â”‚       - Manejo de errores
â”‚
â”œâ”€â”€ ğŸ“ src/
â”‚   â”œâ”€â”€ ğŸ“ config/
â”‚   â”‚
â”‚   â”œâ”€â”€ ğŸ“ controllers/
â”‚   â”‚   â”œâ”€â”€ ğŸ“„ authController.js
â”‚   â”‚   â”‚   â””â”€â”€ Funciones:
â”‚   â”‚   â”‚       - signup
â”‚   â”‚   â”‚       - login
â”‚   â”‚   â”‚       - googleLogin
â”‚   â”‚   â”‚       - completeProfile
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ ğŸ“„ adminController.js
â”‚   â”‚   â”‚   â””â”€â”€ Funciones:
â”‚   â”‚   â”‚       - getAllUsers
â”‚   â”‚   â”‚       - getUser
â”‚   â”‚   â”‚       - updateUser
â”‚   â”‚   â”‚       - deleteUser
â”‚   â”‚   â”‚       - changeUserRole
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ ğŸ“„ lookupController.js
â”‚   â”‚   â”‚   â””â”€â”€ Funciones:
â”‚   â”‚   â”‚       - getAllSports
â”‚   â”‚   â”‚       - getAllLocations
â”‚   â”‚   â”‚       - getLocationsByCountry
â”‚   â”‚   â”‚       - getSportWithPositions
â”‚   â”‚   â”‚
â”‚   â”‚   â””â”€â”€ ğŸ“„ profileController.js
â”‚   â”‚       â””â”€â”€ Funciones:
â”‚   â”‚           - getMyProfile
â”‚   â”‚           - updateProfile
â”‚   â”‚
â”‚   â”œâ”€â”€ ğŸ“ middleware/
â”‚   â”‚   â””â”€â”€ ğŸ“„ auth.js
â”‚   â”‚       â””â”€â”€ Middlewares:
â”‚   â”‚           - verifyToken
â”‚   â”‚           - isAdmin
â”‚   â”‚           - canAccessResource
â”‚   â”‚
â”‚   â””â”€â”€ ğŸ“ routes/
â”‚       â”œâ”€â”€ ğŸ“„ authRoutes.js
â”‚       â”‚   â””â”€â”€ Rutas:
â”‚       â”‚       - /signup
â”‚       â”‚       - /login
â”‚       â”‚       - /google
â”‚       â”‚       - /complete-profile
â”‚       â”‚
â”‚       â”œâ”€â”€ ğŸ“„ adminRoutes.js
â”‚       â”‚   â””â”€â”€ Rutas:
â”‚       â”‚       - /users
â”‚       â”‚       - /users/:id
â”‚       â”‚       - /users/:id/role
â”‚       â”‚
â”‚       â””â”€â”€ ğŸ“„ lookupRoutes.js
â”‚           â””â”€â”€ Rutas:
â”‚               - /sports
â”‚               - /locations
â”‚               - /locations/country/:country
â”‚               - /sports/:sportId/positions

=== DEPENDENCIAS ===

Principales:
- express
- cors
- dotenv
- @supabase/supabase-js
- jsonwebtoken
- bcrypt
- google-auth-library

Desarrollo:
- nodemon

=== TABLAS EN SUPABASE ===

1. users
   - id (int8, PK)
   - created_at (timestamptz)
   - email (varchar)
   - password (varchar)
   - role (text) ['user', 'admin']
   - phone_number (int8)

2. athlete
   - id (int8, PK)
   - created_at (timestamptz)
   - name (varchar)
   - last_name (varchar)
   - birthdate (date)
   - height (int2)
   - weight (int2)
   - location_id (int8, FK â†’ location.id)
   - user_id (int8, FK â†’ users.id)
   - sport_id (int8, FK â†’ sport.id)

3. agent
   - id (int8, PK)
   - created_at (timestamptz)
   - name (varchar)
   - last_name (varchar)
   - description (varchar)
   - user_id (int8, FK â†’ users.id)
   - location_id (int8, FK â†’ location.id)
   - sport_id (int8, FK â†’ sport.id)

4. team
   - id (int8, PK)
   - created_at (timestamptz)
   - name (varchar)
   - job (varchar)
   - description (varchar)
   - user_id (int8, FK â†’ users.id)
   - sport_id (int8, FK â†’ sport.id)
   - location_id (int8, FK â†’ location.id)

5. plan (Para planes premium futuros)
   - id (int8, PK)
   - created_at (timestamptz)
   - name (varchar)
   - price (int8)
   Nota: Esta tabla se utilizarÃ¡ en el futuro para definir los diferentes
   planes premium disponibles.

6. subscription (Para planes premium futuros)
   - id (int8, PK)
   - created_at (timestamptz)
   - end_date (date)
   - user_id (int8, FK â†’ users.id)
   - plan_id (int8, FK â†’ plan.id)
   Nota: Esta tabla se utilizarÃ¡ en el futuro para gestionar suscripciones premium.
   Por defecto los usuarios no necesitan una suscripciÃ³n para usar la plataforma.

7. match_state
   - id (int8, PK)
   - created_at (timestamptz)
   - state (varchar)

8. match
   - id (int8, PK)
   - created_at (timestamptz)
   - match_state_id (int8, FK â†’ match_state.id)
   - user1_id (int8, FK â†’ users.id)
   - user2_id (int8, FK â†’ users.id)

9. chat
   - id (int8, PK)
   - created_at (timestamptz)
   - match_id (int8, FK â†’ match.id)

10. post
    - id (int8, PK)
    - created_at (timestamptz)
    - text (text)
    - url (varchar)
    - user_id (int8, FK â†’ users.id)

11. sport
    - id (int8, PK)
    - created_at (timestamptz)
    - name (varchar)
    - position (varchar)

12. location
    - id (int8, PK)
    - created_at (timestamptz)
    - country (varchar)
    - province (varchar)
    - city (varchar)

=== SEGURIDAD IMPLEMENTADA ===

1. AutenticaciÃ³n:
   - JWT para manejo de sesiones
   - Bcrypt para hash de contraseÃ±as
   - Google OAuth como alternativa de login

2. AutorizaciÃ³n:
   - Middleware de verificaciÃ³n de token
   - Middleware de verificaciÃ³n de rol admin
   - Middleware de verificaciÃ³n de acceso a recursos

3. Seguridad HTTP:
   - CORS configurado
   - Headers de seguridad bÃ¡sicos
   - Manejo de errores global

=== NOTAS ADICIONALES ===

- El proyecto usa el esquema 'public' de Supabase
- Los roles son 'user' y 'admin'
- athlete, agent y team son tipos de perfil para usuarios normales
- El manejo de permisos se hace principalmente desde el backend
- Incluye manejo de errores centralizado
- Preparado para desarrollo y producciÃ³n
